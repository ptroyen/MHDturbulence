\documentclass[12pt,a4paper]{report}

\usepackage{graphics}
\usepackage{listings}
\usepackage{fullpage,epsf,graphicx, amstext,url,bm,amsmath, amssymb, caption} 

%
% head.sty is no longer needed
%
%\usepackage{head,fullpage,epsf,graphicx, amstext,url} 

\lstset{breaklines=true}

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\begin{document}

\thispagestyle{empty}

%                       This is a basic LaTeX Template
%                       for the MSc Dissertation report
%
\parindent=0pt          %  Switch off indent of paragraphs 
\parskip=5pt            %  Put 5pt between each paragraph  
%
%                       This section generates a title page
%                       Edit only the sections indicated to put
%                       in the project title, and submission date
%

\vspace*{0.1\textheight}

\begin{center}
        \huge{\bfseries Study of the Onset of Dynamo Action in Magnetohydrodynamics}\\
\end{center}

\bigskip

\begin{center}
        \large{Andr\'es Cathey Cevallos}\\      % Replace with your name
        \bigskip
        \large{August 18, 2017}        % Submission Date
\end{center}

%%% If necessary, reduce the number 0.4 below so the University Crest
%%% and the words below it fit on the page.
%%% Don't let the crest and the wording below it flow onto the next page!
\vspace*{0.35\textheight}

\begin{center}
        \includegraphics[width=35mm]{crest.pdf}
\end{center}

\medskip

\begin{center}

%%%
%%% Change Theoretical to Mathematical if appropriate
%%%
\large{
  MSc in Theoretical Physics\\[0.8ex]
  The University of Edinburgh\\[0.8ex]
  2017
}

\end{center}

\newpage


\pagenumbering{roman}

\begin{abstract}
This is where you summarise what is in your thesis. It should
be around 100 words, but not more than 200 words.
\end{abstract}

\pagenumbering{roman}


\textbf{Declaration} - goes here. Write some examples!

For example, MC generation code, measurement code, fit code, whether
calculations were done using Mathematica, with(out) gamma matrix code,
master integrals, etc.

\newpage

\tableofcontents
\listoftables
\listoffigures

\begin{titlepage}
\vspace*{2in}
% an acknowledgements section is completely optional but if you decide
% not to include it you should still include an empty {titlepage}
% environment as this initialises things like section and page numbering.
\section*{Acknowledgements}

Put your acknowledgements here. Thanking your supervisor for his/her
help is standard practice, but you don't have to do this\ldots

This template is is modification of the one for the MSc in High
Performance Computing, which is apparently descended from a template
developed by Prof Charles Duncan for MSc students in Meteorology. His
acknowledgement follows:

\emph{This template has been produced with help from many former
  students who have shown different ways of doing things. Please make
  suggestions for further improvements.}

Some parts of this template were lifted unashamedly from the Edinburgh
MPhys project report guide, with little or no modification. I have no
idea who wrote the first version of that\ldots

You don't have to use \LaTeX\ for your dissertation. You can use
Microsoft Word or Apple Pages if you wish, but it's \emph{much} easier
to typeset equations in \LaTeX, and references look after
themselves. Whatever you use, your dissertation should have the same
general structure, and it should look similar to this one --
especially the front page.


\end{titlepage}

\pagenumbering{arabic}

\chapter{Introduction}

Magnetic fields in astrophysical scales have been extensively studied analytically and numerically. From Larmor's publications regarding the Earth's magnetic field to present day numerical simulations of astrophysical magnetic structures, the prevalent mechanism used to explain these magnetic fields is the dynamo effect~\cite{sir1919larmor}. Dynamo theory tries to explain how exactly a fluid that conducts electricity\footnote{The study of magnetic fields generated as a result of electrically conducting fluids, and how they modify the fluids' dynamics is commonly referred to as Magnetohydrodynamics.} can generate a magnetic field. It is straight forward to see how a rotating ring of electrically conducting fluid can generate a magnetic field in the same way that a ring with electric current does. Dynamo theory has been subdivided into different categories based on the particular physical characteristics of the systems which host dynamos. The first distinction is between kinematic dynamos, which considers the flow to be known and not affected by the magnetic field (these can be used in scenarios with very weak magnetic fields), and hydromagnetic, or nonlinear, dynamo for which the flow can be affected by the magnetic field through the Lorentz force~\cite{brandenburg2007hydromagnetic}.

Kinematic (or linear) dynamo theory led to the understanding of several basic principles of dynamos. However, most astrophysically relevant dynamos cannot be dealt with kinematic dynamo theory alone due to the magnetic fields that are generated being too dynamically important~\cite{brandenburg2005astrophysical}. Thanks to advances in numerical simulations (starting with S. Orszag's pioneering work on direct numerical simulations~\cite{orszag1970analytical}) nonlinear dynamo theory has seen meaningful advances. One example of this is the impact it had on Kazantsev's theory~\cite{kazantsev1968enhancement} of the small scale dynamo, since faster computers allowed the study of higher Reynolds number simulations in hydromagnetic turbulence. A topic which is currently being studied with numerical simulations is the case of the non helical small scale dynamo. This is said to be relevant to the origin of magnetic field clusters. An interesting feature that has been recently observed is that when a system with fixed magnetic diffusivity undergoes a considerable decrease of kinematic viscosity the velocity field is too turbulent and it will be harder to excite the dynamo~\cite{schekochihin2004critical}. 

Most of the complications that surround the topic of hydromagnetic dynamos are due to the turbulent nature of the flows that spawn them. Turbulence, as a matter of fact, seems to be the underlying reason behind the emergence (and disappearance) of small scale dynamos. The work presented here is mainly concerned on the onset of dynamo action and the effect that an excess (or absence) of turbulence in the velocity field has on it. An important dimensionless parameter for MHD is the \textit{magnetic Prandtl number}, $Pr_M=\nu/\eta$, which is the relation of the kinematic viscosity $\nu$ and the magnetic diffusivity $\eta$ of the system. Several numerical simulations of homogeneous isotropic turbulence are made in order to study small scale dynamo action, and those with $Pr_M<1$ (very turbulent velocity field) are ultimately compared to the literature~\cite{schekochihin2004critical}. On the other hand, the simulations with more laminar velocity fields are also shown to host no small scale dynamo action, as expected by~\cite{schnack2009lectures}. This scenario is interesting as it is related to magnetic fields of larger scales, such as those of interstellar mediums, protogalaxies, early Universe, etc.~\cite{schekochihin2002small}


\chapter{Hydrodynamics and turbulence}

Before dealing directly with the theoretical aspect of magnetohydrodynamics it is helpful to include a review of the dynamics that rule the flow of non-conducting fluids. Since this work is mainly concerned on homogeneous isotropic MHD, the focus of the brief review on hydrodynamics presented below is of the same nature. 

\section{Non-conducting fluids}

The Navier-Stokes equations describe the dynamics of non-conducting Newtonian fluids. The case of interest is with incompressible fluids, which means that the fluid's density remains constant and can be set to unity. In this case, the velocity field's temporal evolution then can be written as:

\begin{align}
 \partial_t \bm u + (\bm u \cdot \bm \nabla) \bm u = - \bm \nabla p + \nu \nabla^2 \bm u + \bm f_u
 \label{eq2.1}
\end{align}

The incompressibility condition indicates that: 

\begin{align}
 \bm \nabla \cdot \bm u = \bm 0
 \label{eq2.2}
\end{align}

Here the velocity field is the vector $\bm u$, $p$ is the pressure on the fluid, $\nu$ is the kinematic viscosity\footnote{Viscosity is a measure of the friction of the fluid with itself.}, and $\bm f_u$ is an external forcing function that excited the fluid. The nonlinear term, $(\bm u \cdot \bm \nabla) \bm u$, is the one responsible for energy transfer and mixing across different spatial scales, i.e. it is primarily responsible for the turbulent nature of the flow. The first two terms are usually combined by using what is called a advective derivative $\partial / \partial_t + \bm u \cdot \bm \nabla$. The pressure term obviously takes into account how the velocity field changes when there is a difference (gradient) of pressure. Then there is the dissipative term, $\nu \nabla^2 \bm u$, which accounts for the energy that is lost due to the fluid's friction with itself.

Very different dynamics are to be expected depending on whether the nonlinear term or the dissipative term dominates. The Reynolds number $Re$ is an important, dimensionless, quantity that is often used to describe fluids. It is a good measure to quantitatively determine when a fluid has turbulence. It can be said that when a non conducting fluid goes from low Reynolds number to a high Reynolds number it is undergoing a transition from laminar to turbulent flow. Comparing the influence of the non-linear, inertial, term of eqn.~\ref{eq2.1} and the term related to the viscous dissipation it is possible to obtain an expression for such dimensionless quantity, where $L$ and $u$ are simply the length scale and velocity characteristic of the flow\footnote{For a fluid moving along a pipe, $L$ could be the diameter of the pipe and $u$ the rms velocity of the fluid.}.

\begin{align}
 \frac{\vert (\bm u \cdot \bm \nabla) \bm u \vert}{\vert \nu \nabla^2 \bm u \vert} \sim \frac{u \frac{1}{L} u}{\nu \frac{1}{L^2} u} \sim \frac{u L}{\nu} \equiv Re \nonumber
\end{align}

\section{Turbulence}
\label{sec2.2}

It was already mentioned that turbulence is an important, and the complicated, part of hydrodynamics. In order to provide a mathematical description of such a chaotic phenomenon it is necessary to make use of statistics for the velocity field, such that it is of the form of eqn.~\ref{eq2.3} into an average component $\langle \bm U \rangle$ and a randomly fluctuating one $\bm u$, so $\langle \bm u \rangle = \bm 0$ (and for the magnetic field alike when dealing with electrically conducting fluids). Furthermore, in order to study the global characteristics of turbulence, and not just macroscopic effects related to the specific geometry of a physical system, the concept of \textit{Homogeneous} and \textit{Isotropic} turbulence (HIT) is considered~\cite{biskamp1997nonlinear}.

\begin{align}
 \bm U = \langle \bm U \rangle + \bm u
 \label{eq2.3}
\end{align}

In particular, homogeneous isotropic turbulence is obtained by having the fluctuating part of the velocity field to be independent of position, in order for the homogeneity condition to hold, and of direction, for the isotropy to be fulfilled. This is equivalent of $\bm u$ being invariant of spatial translation and of rotational translations, respectively. However, the concept of isotropy that will be considered is that of isotropy without mirror-symmetry, i.e. invariant under $SO(3)$-transformations~\cite{biskamp1997nonlinear}. This means that the system can have kinetic helicity (topologically, helicity is a measure of the handedness of a specific field)~\cite{brandenburg2005astrophysical, hughes1996kinetic}. It should be noted that HIT does not appear in real-world fluids. Due to boundary conditions spatial invariance is not achieved, and any non zero mean velocity field violates isotropy\footnote{It is possible to bypass this problem by considering a Galilean transformation that moves with the mean velocity field.}. However, turbulent fluids far from boundary conditions (like oceanic flows) are often considered, to a good approximation, to be describable with HIT. As such, HIT can be viewed as a way to simplify a complex problem~\cite{LinkmannMoritzFrederikLeon2016Spim}. 

\section{Correlation functions}

For homogeneous turbulence, it is required that the equal time two-point correlation functions:

\begin{align}
 C_{ij}^{uu}(\bm r, t) = \langle u_i(\bm x, t) u_j(\bm x + \bm r, t) \rangle
 \label{eq2.4}
\end{align}

are independent of $\bm x$~\cite{biskamp1997nonlinear}. These functions then only depend on the displacement, $\bm r$. The kinetic energy is a variable that is defined through the two-point correlation function of eqn.~\ref{eq2.4} as $E_K = \frac{1}{2} \langle \bm u (\bm x) \cdot \bm u (\bm x) \rangle$, which is also independent of position. In order to look at the length scales related to these turbulent fluid flows it is helpful to define the longitudinal correlation functions, which only take the field's component in the direction of $\bm r$: 

\begin{align}
 C_{LL}^{uu}(\bm r, t) = \langle u_L(\bm x, t)u_L(\bm x + \bm r, t) \rangle,
 \label{eq2.5}
\end{align}

where the longitudinal velocity field is defined by $u_L(\bm x)=\bm u \cdot \bm r / \vert r \vert$. 

\section{Turbulent length scales}
\label{sec2.4}

Turbulence is nonlinear by nature, it could be said that the nonlinear component of eqn.~\ref{eq2.1} is the one responsible for the development of turbulence. The reason behind this is that $(\bm u \cdot \bm \nabla) \bm u$ takes energy from large length scales and mixes it towards the smaller length scales. Once energy reaches very small scales, comparable to the mean free path of the fluid in question, it starts to rapidly dissipate. Since viscosity is a measure of a fluid's inner friction, and thus of the amount of energy dissipated through heat, it is clear that the length scales where energy is dissipated (as well as the rate at which it is dissipated) will depend on the kinematic viscosity $\nu$. 

It can be said that there are three important length scales associated with homogeneous isotropic turbulence. It is possible to follow a \textit{Gedankenexperiment} as done by D. Schnack~\cite{schnack2009lectures}. Imagine a perfect coffee cup as an infinitely long cylinder of radius $a$ and whose walls do not affect the fluid's flow. Now think of a perfect spoon that is permanently stirring the fluid and exciting a circular eddy with velocity $\bm U_{spoon}$ and radius $a$ as well, as shown in fig.~\ref{fig2.1}.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.4\linewidth]{{img/perfect_mug}.png}
  \caption{Perfect cup with single excited eddy~\cite{schnack2009lectures}.}
  \label{fig2.1}
\end{figure}

It is clear that energy is being input into the system and it is being done at the largest length scales. If no pressure is present and an incompressible fluid is inside the perfect coffee cup, the evolution of the velocity field is described by eqn.~\ref{eq2.6}.

\begin{align}
 \frac{\partial U}{\partial t} + U \frac{\partial U}{\partial t} &= \nu \frac{\partial^2 U}{\partial t^2}
 \label{eq2.6}
\end{align}

The initial velocity is $U(t=0)=U_0 \sin(k_0 x)$, where $k_0=\pi/a$ ($\lambda_0=2a$). It is possible to assume that at long wavelengths viscous effects are negligible, since $Re=U_0 a / \nu \gg 1$, then a short time later, $t=\Delta t \ll 1/(k_0 U_0)$, the velocity is defined by:

\begin{align}
 U(t=\Delta t) &= U(t=0) - \Delta t U \frac{\partial U}{\partial t} \nonumber \\
 &= U_0 \sin k_0 x - \Delta t (U_0 \sin k_0 x)(k_0 U_0 cos k_0 x) \nonumber \\
 &= U_0 \sin k_0 x - \frac{1}{2} k_0 \Delta t U_0^2 \sin 2k_0 x \nonumber
\end{align}

This velocity field a short time after the spoon started to stir the fluid has maintained a component in the largest wavelength $\lambda_0$, and one with exactly half of it! Clearly, the nonlinear component of eqn.~\ref{eq2.6} has managed to transfer energy from larger to smaller length scales. After another small time interval energy is transfered to even smaller length scales.

\begin{align}
 U(t=\Delta t) =& U_0 \sin k_0 x - U_1 \sin 2k_0 x \nonumber \\
 U(t=2\Delta t) =& (U_0-3\Delta t U_1 U_0) \sin k_0 x \nonumber \\
 &- (U_1 + k_0 \Delta t U_0^2) \sin 2 k_0 x \nonumber \\
 &+ 3 \Delta t k_0 U_1 U_0 \sin 3 k_0 x \nonumber \\
 &- 2\Delta t k_0 U_1^2 \sin 4 k_0 x \nonumber 
\end{align}

This effect of energy transfer from the larger to the smaller length scales is commonly referred to as the \textit{energy cascade}. The reason for this is that when the energy is plotted\footnote{In hydrodynamics it is common to transform to Fourier space in order to study the systems at play, and specially for Direct Numerical Simulations.} as a function of the wave number $k$, the most energy remains in the smallest wave numbers because energy is constantly being input into the system by the perfect spoon (largest wave numbers) and it decreases until the largest wave numbers are reached $k_D$ - the ones related to viscous dissipation, as shown in the spectral plot of fig.~\ref{fig2.2}\footnote{The y-axis ($\varepsilon(k)$) it indicates energy.}.

\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.6\linewidth]{{img/cascade}.png}
  \caption{Energy cascade form large to small length scales (wavelengths)~\cite{schnack2009lectures}.}
  \label{fig2.2}
\end{figure}

From the \textit{Gedankenexperiment} above, it is clear that there are three important length scales related homogeneous isotropic turbulence. The largest one is that at which energy is input into the system, and consequently the one which contains most of the kinetic energy, then the inertial range defines the intermediary length scales where the system's nonlinearity dominates, but viscous effects are also important. Finally, the smallest length scale is related to energy dissipation from viscous effects. When dealing with numerical simulations, the contribution of all these length scales has to be determined in order to have a properly resolved simulation.

In order to obtain the characteristic length scale relevant to the system (\textbf{integral scale}), the longitudinal two-point correlation function of eqn.~\ref{eq2.5} is used. This value of $L$ describes the correlation of the fluctuating component of the velocity field at the large scales, and it is used to obtain the Reynolds number~\cite{mccomb1990physics}. To do so, a corresponding characteristic velocity needs to be defined. Since the type of turbulence that is being studied is HIT, it is possible to take the root-mean-squared (rms) velocity to be the aforementioned characteristic velocity. The rms velocity is defined with the kinetic energy $E_K=\frac{1}{2}(u_x^2+u_y^2+u_z^2)=\frac{3}{2}u_{rms}^2$ since the isotropy condition requires rotational invariance, and thus $\langle u_x \rangle = \langle u_y \rangle = \langle u_z \rangle = u_{rms}$.

\begin{align}
 L_u(t) &= \frac{1}{U^2} \int_0^\infty C_{LL}^{uu}(\bm r, t) dr \nonumber \\
 U&=u_{rms}=\sqrt{\frac{2}{3}E_K} \nonumber
\end{align}

An intermediary length scale that describes the range where viscosity starts to become important (in comparison to the nonlinear term) is the \textbf{Taylor length scale}. It is also referred to as the turbulent length scale for this very reason. With the energy dissipation rate as $\varepsilon$, and the kinetic viscosity $\nu$, the Taylor microscale is defined~\cite{LinkmannMoritzFrederikLeon2016Spim}:

\begin{align}
 \lambda_u = \sqrt{\frac{15 \nu}{\varepsilon}} u_{rms} \nonumber
\end{align}

Finally, the smallest length scales of the system are close to the \textbf{Kolmogorov microscale}. At this scale (large wave numbers), most energy is being dissipated into heat~\cite{mccomb1990physics}. The Kolmogorov microscale ``starts'' when the viscous term is equally important to the nonlinear term, i.e. $Re=1$. Working through dimensional analysis it is possible to arrive at the following Kolmogorov microscale related to viscous dissipation:

\begin{align}
 \ell_\nu = \left( \frac{\nu^3}{\varepsilon} \right)^{\frac{1}{4}} \nonumber
\end{align}

From it, it is possible to determine the wave number related to the viscous dissipation, which is then determined by eqn.~\ref{eq2.7}. These large wave numbers will then be necessary to determine important parameters for a given numerical simulation.

\begin{align}
 k_\nu = \left( \frac{\varepsilon}{\nu^3} \right)^{\frac{1}{4}} \label{eq2.7}
\end{align}

The inertial range of the energy cascade of fig.~\ref{fig2.2} has an analytic description by Kolmogorov. In said figure, the kinetic energy spectrum $E(k)$, which describes the energy at each wave number $k$, is shown. The total energy of the system is the summation of the energy of each wave number:

\begin{align}
 E = \sum_k^{k_{max}} E(k)
\end{align}






\chapter{Magnetohydrodynamics}

The field of magnetohydrodynamics (MHD) studies electrically conducting fluids. These can occur in different scales from the flow of liquid sodium in laboratories to the plasma inside nuclear fusion reactors or to the movement of material inside the cores of planets and stars. 

\section{MHD equations}

In general, the equations that govern these fluids are obtained by a combination of Navier-Stokes equations and Maxwell equations. Said governing equations are the following:

\begin{align}
\partial_t \bm u &= - \frac{1}{\rho} \bm \nabla p - (\bm u \cdot \bm \nabla) \bm u + \frac{1}{\rho} (\bm \nabla \times \bm b) \times \bm b + \nu \nabla^2 \bm u + \bm f_u \label{eq3.1} \\
\partial_t \bm b &= (\bm b \cdot \nabla) \bm u - (\bm u \cdot \bm \nabla) \bm b + \eta \nabla^2 \bm b + \bm f_b \label{eq3.2} \\
\bm \nabla \cdot &\bm u = 0 \qquad \text{and} \qquad \bm \nabla \cdot \bm b = 0 \label{eq3.3}
\end{align}

Here the velocity and magnetic fields are defined as $\bm u$ and $\bm b$, respectively and are in units of velocity, $\rho$ denotes the density and can be set to $\rho = 1$ due to the incompressibility condition of eqn.~\ref{eq3.3}, $p$ is the thermodynamic pressure on the fluid, and the kinematic viscosity it denoted by $\nu$. The magnetic diffusivity $\eta=(\mu_0\sigma)^{-1}$ is another intrinsic property of the fluid that is directly related to its electric conductivity $\sigma$. Finally, $\bm f_u$ and $\bm f_b$ are external kinetic (mechanic) and magnetic forcing that could be present. 

A brief, verbal description of the terms in the above equations is important now. The pressure term in the kinetic equation is simply saying that when there exists a gradient in the pressure within a fluid, then it will undergo acceleration towards areas of lower pressure. The non-linear term $(\bm u \cdot \bm \nabla)\bm u$ is the inertial term and it is responsible for the transfer of kinetic energy in the turbulent cascade, as it was explained in section~\ref{sec2.4}. The next term, $(\bm \nabla \times \bm b) \times \bm b$, is simply the influence of the Lorentz force to the fluid's velocity field. The $\nu \nabla^2 \bm u$ term in eqn.~\ref{eq3.1} is related to the dissipation of energy due to viscosity - that is energy being transformed from kinetic to heat due to friction  within the fluid. This happens in the lowest spatial scales and it is where most energy is dissipated.

The first term in the right hand side of eqn.~\ref{eq3.2}\footnote{Equation~\ref{eq3.2} is often referred to as the \textit{Induction equation}.}, $(\bm b \cdot \bm \nabla)\bm u$, is the stretching of the magnetofluid's magnetic field lines due to the flow - this term is responsible for conversion of kinetic energy to magnetic energy. The next term in the r.h.s of eqn.~\ref{eq3.2}, $(\bm u \cdot \bm \nabla)\bm b$, is related to the advection of the magnetic field lines by the fluid's flow. Finally, the term $\eta \nabla^2 \bm b$ is related to diffusion of energy through the magnetic channel. These last two terms can be compared to obtain a similar quantity to the Reynolds number, but for the magnetic contribution. This ratio is also related to turbulence, but magnetic in nature, and it is called the magnetic Reynolds number. 

\begin{align}
 \frac{\vert (\bm u \cdot \bm \nabla) \bm b \vert}{\vert \eta \nabla^2 \bm b \vert} \sim \frac{u \frac{1}{L} b}{\eta \frac{1}{L^2} b} \sim \frac{u L}{\eta} \equiv Re_M \nonumber
\end{align}

Large $Re_M$ means that the evolution of the magnetic field is primarily due to the fluid's flow, and the most extreme case of this scenario is when the magnetofluid is perfectly conducting ($\eta = 0$) and it is called ``ideal MHD''. Small $Re_M$ means that $\bm b$'s evolution is mainly due to the magnetic diffusivity. Typical values of magnetic Reynolds number are the following~\cite{LinkmannMoritzFrederikLeon2016Spim}:

\begin{center}
\begin{tabular}{| c | c |}
 \hline
 Liquid metals & $Re_M \sim 10^{-3}\,-\,10^{-1}$ \\ 
 \hline
 Planet interiors & $Re_M \sim 100\,-\,300$ \\ 
 \hline
 Solar convection zone & $Re_M \sim 10^{6}\,-\,10^{9}$ \\ 
 \hline
 Interstellar or intergalactic medium & $Re_M \sim 10^{18}\,-\,10^{29}$ \\ 
 \hline
\end{tabular}
\end{center}

The relation of these dimensionless quantities gives another important dimensionless parameter, called the magnetic Prandtl number, $Pr_M$. This parameter describes through which channel the majority of the energy is dissipated (kinetic or magnetic).

\begin{align}
 Pr_M = \frac{Re_M}{Re} = \frac{\nu}{\eta} \nonumber
\end{align}

Magnetic Prandtl numbers lower than one mean that most of the energy in the system is being dissipated through the kinetic channel, i.e. through kinematic viscosity. It also means that the kinetic channel is more turbulent than the magnetic one. Conversely, when $Pr_M$ is larger than one, then the magnetic channel is dissipating the majority of the system's energy, and there is less kinetic turbulence than magnetic turbulence. Examples of systems with low and high magnetic Prandtl numbers can be seen in fig.~\ref{fig3.1}. In said image, there are yellow dotted lines which are of constant $Pr_M$ (denoted by $Pm$ in the figure). For unitary magnetic Prandtl number there is a computer and the label DNS - this is related to the fact that it is very complicated to go to high (magnetic) Reynolds numbers with direct numerical simulations, and thus, so far, most results have been obtained in the area around $Pr_M \sim 1$. 

\begin{figure}[!ht]
\centering
\includegraphics[width=0.73\textwidth]{img/PrM_spectrum}
\caption{Magnetic Prandtl number isolines~\cite{plunian2013shell}.}
\label{fig3.1}
\end{figure}

Despite older studies of MHD turbulence have been centered at magnetic Prandtl numbers close to unity, faster computers mean that it is possible to investigate at regions that are drifting away from $Pr_M\sim1$. However, current Direct Numerical Simulations (DNS) methods still cannot move too far away from unity magnetic Prandtl number, and recent papers have reported reaching up to $Pr_M=[10^{-3}:10^3]$~\cite{brandenburg2011dissipation, sahoo2011systematics}. Said pair of papers report the appearance of a power law dependence of the magnetic Prandtl number for the ratio of kinetic and magnetic energy dissipation. Namely, that $\varepsilon_K/\varepsilon_M~\alpha~Pr_M^{0.6}$ for decaying, helical turbulence. These, however, deal exclusively with the large scale dynamo, and thus go beyond the scope of this research.

\section{MHD turbulence}
\label{sec3.2}

As it was mentioned in section~\ref{sec2.2}, turbulence is a complicated process that can be simplified by taking statistical methods, and by restricting the type of turbulence. This comes at a cost, of course, and in the case of homogeneous isotropic turbulence the price is that what is being studied is an extremely idealised system. However, global characteristics of turbulence can be learned from its study.

As it was mentioned before, in a hydrodynamic fluid, high Reynolds numbers are related to turbulent flow, while low Reynolds numbers describe laminar flow. A similar behaviour occurs for electrically conducting fluids. The dimensionless quantity that helps describe turbulence in the magnetic channel is the magnetic Reynolds number, which has been defined above to be inversely proportional to the magnetic diffusivity. Even more comparisons can be made between MHD turbulence and hydrodynamic turbulence. To start with, the study of MHD turbulence also takes a mean component and a fluctuating one for the velocity and magnetic fields:

\begin{align}
 \bm U = \langle \bm U \rangle + \bm u \nonumber \\
 \bm B = \langle \bm B \rangle + \bm b \nonumber
\end{align}

It is worth mentioning once more that the fluctuating components of the above equations ought to follow homogeneity (invariance due to spatial transformations) and isotropy without mirror-symmetry (invariance due to $SO(3)$-transformations) conditions. Additionally, the mean value of \textbf{both} fields has to be zero. As it was mentioned before, a nonzero mean value of the velocity field is not a big problem because using a Galilean coordinate transformation solves the problem, but the same cannot be said for the magnetic field. An average magnetic field will make the flow highly anisotropic, but the perpendicular components to $\langle B \rangle$ may develop small scale structures that would then dissipate energy through $\eta$ while keeping $\langle B \rangle$ smoothly varying. As a consequence, isotropic MHD can have either no average magnetic field and be three dimensional, or it can be two dimensional and represent the perpendicular plane to a nonzero $\langle B \rangle$~\cite{biskamp1997nonlinear}. This means that when looking at HIT for MHD, any system that has a nonzero average magnetic field then the isotropy condition cannot be properly studied. 

Regarding the parallels that can be drawn between MHD and hydrodynamic turbulence, an interesting one are the length scales associated with turbulent processes in the kinetic channel have their magnetic analogues. Using the magnetic field's longitudinal equal time correlation function with itself, eqn.~\ref{eq3.4}, a magnetic integral scale can be defined, which describes the larger scales for the system's magnetic field.

\begin{align}
 C_{LL}^{bb}(\bm r, t) &= \langle b_L(\bm x, t) b_L(\bm x + \bm r, t) \rangle \label{eq3.4} \\
 L_b(t) &= \frac{1}{B^2} \int_0^\infty C_{LL}^{bb}(\bm r, t) dr \nonumber
\end{align}

Similarly, there is a Kolmogorov microscale related to magnetic diffusion:

\begin{align}
 \ell_\eta = \left( \frac{\eta^3}{\varepsilon} \right)^{\frac{1}{4}} \nonumber
\end{align}

Where $\eta$ is the magnetic diffusivity and $\varepsilon$ is the total energy dissipation. From it, a wave number related to dissipation through the magnetic channel is obtained (eqn.~\ref{eq3.5}).

\begin{align}
 k_\eta = \left( \frac{\varepsilon}{\eta^3} \right)^{\frac{1}{4}} \label{eq3.5}
\end{align}

\subsection{Self-organisation and inverse cascade}

As it was mentioned for the case of hydrodynamic turbulence, section~\ref{sec2.4}, when energy is input into the system at the largest length scales (smallest wave numbers), there is transfer of kinetic energy from the large scales towards the small scales, where it is dissipated into heat due to viscosity. This is the so called energy cascade, shown in fig.~\ref{fig2.2}, and it is caused by the nonlinear term of eqn.~\ref{eq2.1}. In MHD turbulence, the kinetic energy still undergoes such a process, but the spectral profile of the magnetic energy has an important difference. 

The magnetic helicity was shown to have a different type of dynamics - an \textit{inverse cascade}, where there was a transfer from the small length scales to the large scales (large wave numbers to smaller ones). Connected to this, it was shown that some magnetic energy should also be transferred from large wave numbers to smaller wave numbers. This occurs due to the emergence of spatially large magnetic fields~\cite{LinkmannMoritzFrederikLeon2016Spim}. The magnetic energy, when close enough to the kinetic range (wave number is small enough such that the nonlinear term is unimportant) should follow the Kazantsev $k^{3/2}$ scaling~\cite{kazantsev1968enhancement, haugen2004simulations}. One consistency check that can be done for the simulations generated is that for the ones with dynamo action the Kazantsev $k^{3/2}$ scaling law is fulfilled.

\section{Dynamo action}
\label{sec3.3}

The discovery of the mechanism that powers the Earth's magnetic field, dynamo theory, began when William Gilbert proposed that it was a consequence of Earth itself being magnetic in \textit{De Magnete}. After Michael Faraday's invention of the non-fluid dynamo, Joseph Larmor in 1919 suggested that a convective fluid dynamo could be generating the magnetic field. Elsasser theorised that geomagnetism is generated by electric currents in Earth's fluid outer core -- this is the presently accepted notion. Additionally, convection of the outer core has been shown to be the reason why ohmic decay does not kill Earth's magnetic field~\cite{stern2002millennium}. Paleomagnetism on Earth has shown that its magnetic field has undergone (semi)periodic polarity reversals, which has been (to some extent) modeled numerically~\cite{glatzmaier1995three}. Problems with accurately modeling geomagnetism arise due to the fact of small scale fluctuations of the electrically conducting fluid(s) that located in Earth's outer core.

It is not surprising to then discover that other astrophysical bodies maintain their magnetic field through dynamo action, mainly stars and other plants. Furthermore, dynamo action at small and large scales appears in various astrophysical scenarios. Due to this, their study is fundamental in the understanding of magnetic fields at all length scales.

In the broad context of MHD, dynamo action refers to the conversion of kinetic energy to magnetic energy. The study of dynamos in physics was primarily driven by the quest to determine what is the underlying reason for the magnetic fields in the universe (large scale), as well as their structure, dynamics and maintenance. The term ``dynamo action'' can be loosely defined as a process that can generate and/or amplify magnetic fields. 

To provide a general description of dynamo action consider an electrically conducting fluid that occupies a finite volume $V$ and surface $S$. This magnetofluid is characterised by a magnetic diffusivity $\eta$, and it is surrounded by a vacuum of volume $\hat{V}$. These two volumes denote the volume of the entire universe, such that $V_\infty = V + \hat{V}$. A set of constraints exist for this fluid:

\begin{align}
 \bm \nabla \cdot \bm u &= 0 \qquad \qquad \text{within V} \nonumber\\
 \bm u \cdot \bm{\hat{n}} &= 0 \qquad \qquad \text{on S} \nonumber
\end{align}

The velocity field $\bm u$ and the current density $\bm J$ exist only within $V$, but not in $\hat{V}$. The magnetic field $\bm b$ occupies $V_\infty$ and it is entirely produced by the current density $\bm J$. The characteristic length of this system is the size of the largest eddies - these being constrained to the volume $V$. This means that we can define this characteristic length as $L \sim V^{1/3}$. We know that the magnetic field will behave as a dipolar field at large enough distances, which means that it will decay as $b \sim 1/r^3$ as $r \rightarrow \infty$. The equations that govern the temporal evolution of the magnetic field are eqns.~\ref{eq3.6} and~\ref{eq3.7}.

\begin{align}
 \frac{\partial \bm b}{\partial t} = \bm \nabla \times (\bm u \times \bm b) + \eta \nabla^2 \bm b \qquad \qquad &\text{in V}
 \label{eq3.6} \\
 \bm \nabla \times \bm b = \bm 0 \qquad \qquad &\text{in $\hat{V}$} \label{eq3.7}
\end{align}

The latter is a constraint on having current density in the outer volume. It is possible to take an initial condition of the from $\bm b(\bm r, t=0) = \bm b_0(\bm r)$, and to define the total magnetic energy as eqn.~\ref{eq3.8}, which does not diverge since $\vert \bm b \vert^2 dV \sim 1/r^3$. Due to the diffusive term in eqn.~\ref{eq3.6}, if the velocity field is $\bm u = \bm 0$ at all times, then the total magnetic energy will go to zero as time increases. That is $E_M(t) = 0$ as $t \rightarrow \infty$.

\begin{align}
 E_M(t) = \frac{1}{2 \mu_0} \int_{V_\infty} \vert \bm b \vert^2 dV
 \label{eq3.8}
\end{align}

A definition of dynamo action will be more complete now: \textit{For a given velocity field $\bm u$ and magnetic diffusivity $\eta$, it can be said that $\bm u$ acts as a dynamo if the total magnetic energy does not decay to zero as time goes to infinity ($E_M (t) \neq 0$ as $t \rightarrow \infty$)}~\cite{schnack2009lectures}.

\subsection{Linear and nonlinear dynamos}

Here there exists a division between different types of dynamos. Namely, the velocity field that is used to solve the induction equation (eqn.~\ref{eq3.6}) can be either defined beforehand (linear dynamo) or it can be solved in parallel with the induction equation by solving eqn.~\ref{eq3.1} (nonlinear dynamo). For linear (or kinematic) dynamos, the only requirement for the velocity field is that it is kinematically possible, i.e. the joint field  $\left[ \bm u(\bm r, t), \rho(\bm r, t) \right]$ must satisfy the equations:

\begin{align}
 \frac{\partial \rho}{\partial t} + \bm \nabla \cdot (\rho \bm u) &= 0 \nonumber \\
 \bm u \cdot \bm{\hat{n}} &= 0 \nonumber
\end{align}

While the kinematic dynamo is less constrained than the nonlinear (or hydromagnetic) dynamo, and its solutions are linear, and thus easier to obtain, only scenarios where the kinetic energy is much greater than the magnetic energy can be considered. This is because the back reaction of the magnetic field through Lorentz force is not considered. Despite this drawback, a lot of work has been done regarding kinematic dynamo theory because the resulting theory is linear in $\bm b$, and since in many astrophysical scenarios the kinetic energy is very large when compared to the magnetic energy. A theoretical lower bound for a critical magnetic Reynolds number ($Re_M^{crit.} \sim 10$) can be obtained with linear dynamo theory. It is expected that this value is too small for turbulent flows where the magnetic energy is large enough to modify the velocity field~\cite{schnack2009lectures}. Another notable analytic finding regarding dynamo theory is a process that can lead to amplification of the magnetic field called the ``stretch, twist, fold'' mechanism (fig.~\ref{fig3.2})~\cite{vauinshteuin1972origin}. 

\begin{figure}[!ht]
\centering
\includegraphics[width=0.73\textwidth]{img/STF}
\caption{Stretch-twist-fold cycle~\cite{moffatt1985topological}.}
\label{fig3.2}
\end{figure}

Linear dynamo theory also arrived to a series of constraints for flows which cannot achieve dynamo action. These were denoted antidynamo theorems, like Cowling's theorem, which states that dynamo action is impossible in axisymmetric systems. Other antidynamo theorems say that toroidal (in the direction of rotation) magnetic fields in axisymmetric systems cannot be maintained, others that purely toroidal flows, or that two dimensional plane motions, cannot lead to dynamo action. All of these theorems imply that a key component for dynamo action is the breaking of symmetry, like three dimensionality, for example. The stretch-twist-fold mechanism is a three dimensional symmetry breaking process that requires kinetic helicity (eqn.~\ref{eq3.9}, where $ \bm \omega(\bm x, t) = \bm \nabla \times \bm u(\bm x, t)$ is the vorticity)~\cite{LinkmannMoritzFrederikLeon2016Spim}. In particular, the fluctuating components of the velocity field are isotropic, but break mirror-symmetry ($\langle \bm u \cdot \bm \omega \rangle \neq 0$ when there is no mirror-symmetry). These conditions lead to $\alpha$-\textit{effect}, i.e the appearance of a nonzero mean magnetic field $\langle \bm B \rangle$, which is characteristic to large-scale dynamo action.

\begin{align}
 H_K(t) &= \int_\Omega d \bm x \bm u(\bm x, t) \cdot \bm \omega(\bm x, t) \label{eq3.9}
\end{align}

\subsection{Small scale and large scale dynamos}

An important distinction that is made regarding the length scales at which the magnetic fields generated by dynamo action. Those created by material flow in Earth's outer core are coherent in large spatial scales and are thus dubbed large-scale dynamos (LSD). On the other hand, when a dynamo's generated magnetic field exist at spatial scales smaller than the energy-carrying eddied, then it is called a small-scale dynamo (SSD). This distinction is important as the SSD exists only for large values of magnetic Reynolds number $Re_M \gg 1$. In the particular case of isotropic turbulence, the distinction between SSD and LSD action is intimately tied with the kinetic helicity of the system. Namely, non-helical flows \textit{can} spawn SSD action, whereas LSD action arises in helical flows - which is why $\alpha$-effect is exclusively a LSD effect.

Since turbulent MHD encompasses problems from vastly different nature, for the purpose of this dissertation, the focus will be centered on forced, non-helical, incompressible, homogeneous, isotropic MHD turbulence. This problem dates back to Batchelor, who determined that for non-helical turbulence the small scale components of the velocity field have the most influence on the magnetic field~\cite{batchelor1950spontaneous}. Since HIT is being considered, then it is not possible to have a mean magnetic field, $\langle \bm B \rangle = 0$. This means that the magnetic field in play is a fluctuating component $\bm b$ generated by a turbulent dynamo. The problem of the small-scale dynamo then is being studied here. 

\subsubsection{Kazantsev theory}

In turbulent enough flow, constituent particles randomly ``walk'' away from each other with time. A magnetic field line that is frozen into the fluid will then be stretched by the particles' movement (stretching in eqn.~\ref{eq3.1} is the term $(\bm b \cdot \bm \nabla)\bm u$). In time, this will lead to an increase in the magnetic field if the fluid is incompressible. As $\bm b$ increases Ohmic dissipation increases until a balance is reached with the growth from this random stretching. This was studied (for non-helical flows) by Kazantsev, who found that in certain circumstances dynamo action could be achieved. He did so by first considering HIT in MHD and random, gaussian, velocity and magnetic fields with zero mean fields $\delta$-correlated in time. 

Afterwards, equations for the equal time two-point correlation functions of the velocity and magnetic fields allowed him to derive an equation for the two-point correlation function of the magnetic field for non-helical HIT. Using that, a Schroedinger-type time independent equation arose. These showed the possibility of bound states, provided a critical magnetic Reynolds number $Re_M^{crit}$ within the range [30:60] was reached, which meant that a small-scale dynamo was being excited~\cite{brandenburg2005astrophysical, kazantsev1968enhancement}. In Kazantsev's theory, the aforementioned critical magnetic Reynolds number needs to arise in a situation when $\nu \geq \eta$, i.e. when the magnetic Prandtl number greater or equal than unity~\cite{kazantsev1968enhancement}. The value of $Re_M^{crit}$ can be decreased by injecting kinetic helicity into the problem--this also makes the magnetic energy to be placed mainly in the large scales, i.e. achieves large-scale dynamo action, as a consequence of the $\alpha$-effect~\cite{leorat1981fully}.

Recently, numerical simulations of forced, non-helical, incompressible HIT in MHD have suggested that there is a dependence on the kinetic Reynolds number for the critical magnetic Reynolds number. Particularly, that dynamo action can be ``shut down if the magnetic Prandtl number $Pr_M = Re_M/Re$ is less than some critical value $Pr_M^{crit.} \lesssim 1$ even for $Re_M$ for which dynamo exists at $Pr_M \geq 1$''~\cite{schekochihin2004critical}. This can be observed by keeping the magnetic diffusivity constant and varying the magnetic Prandtl number for an $\eta$ that maintains dynamo action when $Pr_M\gtrsim1$.


\iffalse
The equal time two-point correlation function of the velocity field is then required to be described by $C_{ij}^{uu}(\bm r, t)=T_{ij}(r)$, where $T_{ij}(r)$ has to be of the form of eqn.~\ref{eq3.10} ($T_N(r)$ and $T_L(r)=C_{LL}^{uu}(r)$ are the transverse and longitudinal correlation functions of the velocity field, respectively). 

\begin{align}
 T_{ij}(r) &= \left( \delta_{ij} - \frac{r_i r_j}{r^2} \right) T_N(r) + \frac{r_i r_j}{r^2} T_L(r) \label{eq3.10} \\
 T_N(r)&=\frac{1}{2r}\frac{\partial}{\partial r} \left[r^2 T_L(r) \right], \qquad \qquad\text{if }\bm \nabla \cdot \bm u = 0  \nonumber
\end{align}

Since similar considerations were made for the magnetic field (and $\bm \nabla \cdot \bm b = 0$ is one of Maxwell equations) the equal time two-point correlation function of $\bm b$ is $C_{ij}^{bb}(\bm r, t) = M_{ij}(r)$, defined by eqn.~\ref{eq3.11}, for which $M_N(r)$ is the transverse correlation function of the magnetic field and $M_L(r)=C_{LL}^{bb}(r)$ is that of the longitudinal magnetic field.

\begin{align}
 M_{ij}(r) &= \left( \delta_{ij} - \frac{r_i r_j}{r^2} \right) M_N(r) + \frac{r_i r_j}{r^2} M_L(r) \label{eq3.11} \\
 M_N(r)&=\frac{1}{2r}\frac{\partial}{\partial r} \left[r^2 M_L(r) \right] \nonumber
\end{align}

\fi

\chapter{Direct numerical simulations}

Having stated \textit{some} important theoretical results regarding homogeneous isotropic turbulence (HIT) for magnetohydrodynamics (MHD), like the existence of a critical magnetic Reynolds number for small-scale dynamo action, it is important to note that the main technique for investigating turbulence is through numerical simulations. This has to do with the fact that analytic solutions for the MHD equations~(\ref{eq3.1}-~\ref{eq3.3}), even for the simplest turbulent flows, do not exist~\cite{moin1998direct}. Different numerical methods have been developed to analyse MHD turbulence depending on the specific problem that is being studied. Jumping on the progress made for hydrodynamics, the first simulation for  dynamic MHD was published in 1980~\cite{norman2010historical}. For example, if the smaller length scales relevant to the problem can be neglected, one might want to use Reynolds-averaged Navier–Stokes (RANS) or Large Eddy Simulations (LES) for a slightly more complex description. The main motivation for choosing RANS or LES is that resolving the smaller length scales is very computationally expensive and not necessary for certain problems. However, if all the length scales in the problem need to be resolved, then Direct Numerical Simulations (DNS) ought to be used. 

As far as numerical methods for solving (magneto)hydrodynamic equations go, DNS is by far the most complex and computationally expensive. As a consequence, DNS was very limited in the size of simulations that it could preform in its early stages\footnote{The size of a DNS simulation determines the wave numbers (length scales) that it can achieve, and thus the Reynolds number that can be simulated. The number of operations required for DNS scales with $Re^{9/4}$~\cite{mccomb1990physics}.}. Direct numerical simulations were developed by Orszag and Patterson in the 1970s, where they simulated 3D hydrodynamic isotropic turbulence in a periodic box of $32^3$ grid points with periodic boundary conditions~\cite{orszag1970analytical}. Around $50$ years after their pioneering work, and with the use of paralellisation and graphic card units (GPUs), the largest DNS simulation is one of $4096^3$ grid points~\cite{yokota2013petascale}. A brief account of what is DNS and how codes that use it are set up is initially provided. 

\section{DNS basics}
\label{sec4.1}

Broadly, DNS is a type of simulation that solves the Navier-Stokes equations for hydrodynamics, and the Maxwell equations as well for MHD, without the use of turbulence models. Alternatively, DNS resolves all the spatial and temporal scales related to a specific problem. In order to solve the Navier-Stokes equations, DNS uses a pseudo-spectral method. A brief description of a DNS procedure is provided in this section. 

Direct numerical simulations are done in a cubic box with a predetermined number of grid points $N^3$. The size of the cubic grid is directly related to the spatial length scales that can be resolved in a simulation. In order to simulate laminar flow, small spatial scales are not too important, so small box sizes can be used. However, a fully resolved simulation of turbulent dynamics requires that small scales are reached. Orszag and Patterson's simulation with $32^3$ grid points was only able to resolve a flow with barely no turbulence - Reynolds number of $Re \sim 50$~\cite{moin1998direct}. Table~\ref{table4.1} shows how the amount of wave numbers that can be reached by increasing the box size, which can be summarised by eqn.~\ref{eq4.1}, where $\lfloor \cdot \rfloor$ denote the floor function~\footnote{This was obtained thanks to PhD. c. Mairi McKay.}.

\begin{table}[h]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\textbf{Grid points} & $\bm{ k_{max}}$ \\
\hline
  $16^3$            &  4          \\ \hline
  $32^3$            &  9          \\ \hline
  $64^3$            &  20          \\ \hline
  $128^3$            &  41          \\ \hline
  $256^3$            &  84          \\ \hline
  $512^3$            &  169          \\ \hline
  $1024^3$            &  340          \\ \hline
  $2048^3$            &  681          \\ \hline
\end{tabular}
\end{center}
\caption{This table shows the maximum wave number that can be reached for different box sizes in the eDNS code written by Dr. Sam Yoffe and modified by Dr. Moritz Linkmann~\cite{yoffe2013investigation, LinkmannMoritzFrederikLeon2016Spim}.}
\label{table4.1}
\end{table}

\begin{align}
 k_{max} = \left\lfloor \frac{N}{3} \right\rfloor - 1
 \label{eq4.1}
\end{align}


The main problem with computational fluid dynamics is the nonlinear term $(\bm u \cdot \bm \nabla) \bm u$ in the Navier-Stokes (and MHD) equations. As it was mentioned previously, this term is directly related to turbulence in a system. In order to reformulate the Navier-Stokes equations to have only one dynamic variable\footnote{For MHD two dynamic variables will exist, the velocity and the magnetic fields.}, the velocity field, it is necessary to Fourier transform (FT) them and to use the incompressibility condition $\dot{p}=\bm \nabla \cdot \bm u = 0$ (or an equation of state $p=p(\rho)$). This means to set the pressure term as a function of the velocity field. However, the nonlinear term remains in the new equations and now it is a convolution over all possible wave numbers~\cite{mccomb1990physics}!
 
After generating a velocity field, the Fourier-transformed Navier-Stokes equations are then numerically solved. It is worth noting that the nonlinear convolution alone will require $\mathcal{O}(N^6)$ operations~\cite{mccomb1990physics}. This will scale horribly when dealing with large boxes. But wait, that's $\mathcal{O}(N^6)$ operations for the nonlinear term per time step! In order to mitigate this problem, the convolution theorem is used. The convolution theorem states that a convolution's Fourier transform $\mathcal{F}\{f \ast g\}$ is defined by the point-wise product of the Fourier transform of its components $\mathcal{F}\{f\} \cdot \mathcal{F}\{g\}$. This means that the convolution can be described as $f \ast g = \mathcal{F}^{-1}\{ \mathcal{F}\{f\} \cdot \mathcal{F}\{g\} \}$. Using fast Fourier transforms\footnote{Since Fourier transforms involve infinite sums, which cannot be numerically performed, FFTs are used as an alternative. This, however, generates aliasing errors. More on aliasing errors on eDNS2017 can be found in ~\cite{yoffe2013investigation}.} (FFT), and considering that for the nonlinear term in the Navier-Stokes equation, the computational complexity for obtaining the nonlinear term is decreased to $\mathcal{O}(N^3 \log_2 N)$~\cite{mccomb1990physics}.

The pseudo-spectral method does help in decreasing the number of operations required to obtain the nonlinear term. However, this needs to be done in every single time step (and for two fields in MHD). Exactly what time stepping strategy is used, that depends on different codes. As far as the actual value of the time step, each code will have a Courant–Friedrichs–Lewy (CFL) condition to make sure the results do not diverge. For the MHD code that was used for the simulations shown later, a forward in time Heun's method was used and the CFL condition was $dt < 0.1/(u_{rms}k_{max})$. This means that $dt$ is inversely proportional to the box size, which means that larger boxes will need smaller time steps. It is clear how expensive it is to get simulations that resolve all length scales, and why making simulations in larger boxes is very time consuming~\cite{yoffe2013investigation, LinkmannMoritzFrederikLeon2016Spim}. 

What was mentioned above is simply a short introduction to DNS, and it is considerably more complicated than what was shown. However, for the purpose of this work no more details will be given on the additional intricacies of DNS. Given that in the present work the onset of small-scale dynamo action is being investigated it is of great importance to resolve the smallest length scales of the problem. This means that the type of numerical simulation required is DNS. Keeping in mind that running large boxes with DNS is computationally expensive (and thus financially expensive) it is worth mentioning how to choose the appropriate box sizes for a given set of initial parameters.

\section{DNS resolution}
\label{sec4.2}

As it was mentioned in sections~\ref{sec2.4}~and~\ref{sec3.2}, problems with turbulence have various length scales associated with different physical processes. As it was mentioned before, all simulations performed for this work force the velocity field at the larger spatial scales. This means that the largest scales that need to be resolved are the ones at which the forcing injects energy to the system - this occurs at wave numbers $k=1$ or $k=2$. Due to the nonlinear term an energy cascade (or inverse cascade) takes the energy form the smallest wave numbers (largest spatial scales) to higher wave numbers (smallest spatial scales). As it was mentioned before, the smallest length scales in turbulent flows are the ones related to dissipation due to viscosity or magnetic diffusivity, i.e. the Kolmogorov microscales (eqn.~\ref{eq4.2} for length scales, and eqn.~\ref{eq4.3} for wave numbers associated with diffusion, where $\varepsilon$ is the total energy diffusion and $\nu$ and $\eta$ are the kinetic viscosity and magnetic diffusivity, respectively)~\cite{yoffe2013investigation, LinkmannMoritzFrederikLeon2016Spim}.

\begin{align}
 \ell_\nu = \left( \frac{\nu^3}{\varepsilon} \right)^{\frac{1}{4}} \qquad \qquad \qquad \qquad \qquad \ell_\eta = \left( \frac{\eta^3}{\varepsilon} \right)^{\frac{1}{4}}
 \label{eq4.2}\\
 k_\nu = \left( \frac{\varepsilon}{\nu^3} \right)^{\frac{1}{4}} \qquad \qquad \qquad \qquad \qquad k_\eta = \left( \frac{\varepsilon}{\eta^3} \right)^{\frac{1}{4}} \label{eq4.3}
\end{align}

Consequently, to fully resolve any simulation, the requirement that must be fulfilled is that $k_{max} > max(k_\nu, k_\eta)$. However, to be sure that the dissipative length scales are appropriately resolved, the following rule of thumb was followed for the simulations performed to study MHD turbulence: ${k_{max}/max(k_\nu, k_\eta)\geq1.25}$ - this is dubbed a fully resolved simulation. This means that wave numbers higher than the Kolmogorov microscales are also resolved - this is important because dissipation not \textbf{only} occurs at $k_\nu$ and $k_\eta$, but also at surrounding wave numbers as well. When $1<{k_{max}/max(k_\nu, k_\eta)<1.25}$ the simulation is said to be partially resolved. 

\section{eDNS2017}

All the simulations that are shown in this work were preformed in the eDNS2017 code. This code was initially written by S. Yoffe in 2012 to study hydrodynamic turbulence~\cite{yoffe2013investigation}. It was later extended my M. Linkmann to simulate MHD as well. All benchmarking for the MHD code was done by M. Linkmann as a part of his doctoral research~\cite{LinkmannMoritzFrederikLeon2016Spim}. The eDNS code first discretises the cubical box depending on table~\ref{table4.1}.

Afterwards, the velocity and magnetic fields are initialised. This is done by using Gaussian distributions (with mean 0 and variance 1) for the velocity and magnetic fields in configuration space~\cite{yoffe2013investigation}. These fields do not have to be a solution of the MHD equations. These are then Fourier transformed to inject initial helicity into the system (depending on the given initial conditions). Both fields are then normalised with an equipartition of kinetic and magnetic energy. 

Fourier analysis methods are widely used when systems are described by coupled partial differential equations. This is mainly because only temporal derivatives remain and spatial derivatives transform as $\bm \nabla \rightarrow -i \bm k$. This turns partial differential equations to linear ordinary differential equations in Fourier space. As it was mentioned before, the convolution term when dealing with the Fourier representation of the Navier-Stokes (or MHD) equations is problematic and can be dealt with by using the convolution theorem. To do so, FFTs are used to go back and forth between spectral and configuration space. The time stepping strategy used for eDNS2017 is Heun's method, which is an explicit second-order predictor-corrector scheme. A more detailed description of the eDNS2017 code can be found in~\cite{LinkmannMoritzFrederikLeon2016Spim, yoffe2013investigation}.

\subsection{Forcing}

Another important part of the eDNS2017 code is the type of forcing used to inject energy into the system. It is worth noting that the code allows to study isotropic turbulence for decaying (no energy injected into the system) or forcing (energy injected in order to reach a steady state)~\cite{LinkmannMoritzFrederikLeon2016Spim}. This forcing comes as $\bm f_u$ and $\bm f_b$ in eqns.~\ref{eq3.1} and~\ref{eq3.2}. However, for the simulations that were performed only the velocity field was forced, and from it energy was transferred to the magnetic field through the Lorentz force. From stationary simulations, the forcing function used\footnote{The forcing used for the non-helical simulations was negative damping, which is thoroughly described in~\cite{chalupa2017comparison}} injects energy by feeding a rescaling of the velocity field into the large spatial scales. More precisely, $\bm f_u$ is given by:

\begin{align}
 \bm f_u(\bm k, t) &= \frac{\varepsilon_W}{2 E_f} \bm u(\bm k, t) \qquad \text{for} \qquad 0 < \vert \bm k \vert \leq k_f; \nonumber \\
 &= 0 \,\, \qquad \qquad \qquad \text{otherwise,} \nonumber
\end{align}

where $\varepsilon_W$ is the energy input rate, $E_f$ is the total energy contained in the forcing wave number band ($0 < \vert \bm k \vert \leq k_f$), and $k_f$ is the largest wave number for which forcing is applied ($k_f=2$ in all simulations). Finally, $\bm u(\bm k, t)$ is the velocity field in spectral space, i.e. the Fourier transform of the velocity field in configuration space~\cite{LinkmannMoritzFrederikLeon2016Spim}. This can be defined as an input parameter in the eDNS2017 code. 

Determining the value of the energy input rate needs to be carefully considered. The main considerations that need to be made to determine what numerical value to assign to $\varepsilon_W$ are the time step $dt$, and the energy dissipation of the system. In order for a forced simulation to obtain a steady state, it must ensure that $\frac{dE}{dt}=\varepsilon_W - \varepsilon_T = 0$, where $\varepsilon_T$ is the total energy dissipation.

\subsubsection{Helical forcing}

In order to achieve large-scale dynamo action, the system must have kinetic helicity. The best way to do this is to have the forcing routine inject helicity to the system. This can be done by using a forcing routine given by:

\begin{align}
 \bm f_h(\bm k, t) &= A(\bm k, t) \bm{e_1}(\bm k) + B(\bm k, t) \bm{e_2}(\bm k), \nonumber
\end{align}

where the basis vectors $\bm{e_i}(\bm k) \perp \bm k$ for $i=1, 2$ and $\bm{e_1}(\bm k)\cdot \bm{e_2}(\bm k)^\dagger = 0$,  $A$ and $B$ are complex numbers defined below:

\begin{align}
 A(\bm k, t) = \sqrt{F(k)} \, g_A e^{i \alpha(\bm k)} \nonumber \\
 B(\bm k, t) = \sqrt{F(k)} \, g_B e^{i \alpha(\bm k)} \nonumber
\end{align}

In the above equations, $F(k)$ is a normalisation factor, $g_A^2+g_B^2=1$, and $e^{i\alpha(\bm k)}$ is a uniform random phase. More information about the forcing routines used in eDNS2017 can be found in~\cite{yoffe2013investigation, LinkmannMoritzFrederikLeon2016Spim}.

\section{Paralellisation}

One of the problems with DNS is the memory required to hold the contents of the velocity and magnetic fields in every time step. Since working memory is not unlimited, box sizes larger than $32^3$ cannot be modeled without the use of paralellisation. In computer simulations, this means that the problem is split into different pieces and solved by different processors with (some) communication between them. Maximizing the number of processors while minimising communication between them allows for more time efficient numerical simulations. The paralellisation method used in eDNS is to divide the cubic box of size $N^3 = (2^n)^3$ in $2^m$ (where $m\leq n$) ``slices'' and have the $m$ processors take care of each slice, like shown in fig.~\ref{fig4.1}~\cite{yoffe2013investigation}. 

\begin{figure}[!ht]
\centering
\includegraphics[width=0.4\textwidth]{img/slices}
\caption{Paralellisation method through horizontal slices of the cubic box~\cite{yoffe2013investigation}.}
\label{fig4.1}
\end{figure}

The eDNS2017 code uses OpenMPI\footnote{OpenMPI is an open-source Message Passing Interface implementation protocol.} to run on ARCHER, a Cray XC30 supercomputer at the University of Edinburgh’s Advanced Computing Facility. When working on ARCHER, parallel jobs are submitted to a queue and, for a predetermined amount of time, run on a large number of nodes. %Each process has access only to its own data, but they need to know information from the neighboring processes. This means that some communication has to occur between processors.

\section{Running the code}

The code written by Yoffe and Linkmann handles an input file to read the parameters of the simulation, \texttt{input.in}. In said file, the time step \texttt{DT} has to be determined by making use of the CFL condition mentioned in section~\ref{sec4.1}, the simulation time \texttt{TIME} is also stated. The fluid's kinematic viscosity, \texttt{VISC}, and the magnetic Prandtl number \texttt{PRANDTL} can also be modified (and with them the magnetic diffusivity can be changed too). The lattice size, \texttt{LATTICE}, can be changed, but only such that $N=2^n$, where $n \in \mathbb{Z}$. Other parameters like the hypoviscosity, hyporesistivity, cross-helicity, forcing through the magnetic channel, that have not been discussed here can also be changed. For the simulations performed, however, these were all kept unchanged. 

A sample input file for eDNS2017 is shown in the Appendix~\ref{apx1}. For said input file, the only things that were changed for the simulations presented in this work were: the time step that was used had to be changed depending on the size of the box. Table~\ref{table4.2} was used as a guide to choose the time step\footnote{It is worth noting that the time step also shows a dependence with the viscosity and the resistivity: $dt_\nu < 0.1/(\nu k_{max}^2)$ and $dt_\eta < 0.1/(\eta k_{max}^2)$. But for the values of $\nu$ and $\eta$ used, $dt<min(dt_\nu, dt_\eta)$~\cite{yoffe2013investigation}.}.

\begin{table}[h]
\begin{center}
\begin{tabular}{|c|c|}
\hline
\textbf{Grid points} & $\bm{dt_{max}}$ \\
\hline
  $16^3$            &  0.0387          \\ \hline
  $32^3$            &  0.0172          \\ \hline
  $64^3$            &  0.0077          \\ \hline
  $128^3$            &  0.0038          \\ \hline
  $256^3$            &  0.0018          \\ \hline
  $512^3$            &  0.0009          \\ \hline
  $1024^3$            &  0.0004          \\ \hline
  $2048^3$            &  0.0002       \\ \hline
\end{tabular}
\end{center}
\caption{This table shows the maximum time step that can be used for boxes of different sizes. It is built with the CFL condition mentioned in section~\ref{sec4.1} ($dt < 0.1 / (u_{rms} k_{max})$).}
\label{table4.2}
\end{table}

For most cases, a total code time of \texttt{TIME~~100} was enough to reach a steady state, but for simulations close to the transition from dynamo on to dynamo off it was needed to go to around \texttt{TIME~~400}. Viscosity was varied from $\nu=$\texttt{VISC~~0.0005} to \texttt{1.0}, where the largest values of viscosity are related to flows that are not particularly turbulent, or even laminar. The lattice sizes that were used were $N$=\texttt{LATTICE~~64}, \texttt{128}, \texttt{256}, and one simulation with \texttt{1024}.

In order to have non-helical simulations the parameter \texttt{F\_UHELICITY} was set to \texttt{0.0}, while for fully helical simulations it was set to \texttt{1.0}. Finally, the magnetic Prandtl number was changed by modifying \texttt{PRANDTL}. The working range for $Pr_M$ in this work was \texttt{0.1} to \texttt{100}. All other parameters were kept unchanged from the sample input file, \texttt{input.in}, shown in appendix~\ref{apx1}.

\section{Post-processing}

Once a simulation reaches the final time that was chosen in the input file, two files are given to work with. These hold the spectral information of the velocity and magnetic fields for each time step. Three post-processing scripts written by Yoffe and Linkmann in \texttt{bash} were used to analyse these spectral files. One (\texttt{ensemble\_spectra.sh}) takes each spectral file and averages their values in a given time range, e.g. \texttt{TIME}=[\texttt{50:100}], for a given time interval, e.g. \texttt{1} to take 50 samples or \texttt{2} to take 25. In order to get the parameters of the spectral files as a function of time, \texttt{process\_MHD.sh}, is used. This script performs summations like $\sum_k^{k_{max}}$ to obtain various quantities (like the kinetic and magnetic energies) as functions of time. Finally, in order to obtain temporal averages of the quantities generated by the \texttt{process\_MHD.sh} script, \texttt{time\_average.sh} is used in a similar way as \texttt{ensemble\_spectra.sh} by giving a time range and a time interval. It is worth noting that these post-processing scripts output their respective results with the appropriate statistical errors.

In addition to the post-processing scripts mentioned above, several others were written to automate the use of \texttt{Gnuplot} to perform graphs and heat maps, check for the existence of dynamo action in the end of every simulation, or obtain relevant values to each simulation. For example, and with the use of some information from the input file, the Kolmogorov microscales (along to their relation to the maximum wave number), Reynolds number, and magnetic Reynolds number with their appropriate statistical errors. These additional post-processing scripts were performed using \texttt{Bash} and \texttt{Python}. Finally, \texttt{Paraview} was used in order to generate plots of the velocity and the magnetic fields for some simulations. 















\chapter{Results}

A detailed account of the simulations that were generated, along with their motivations, is provided in this chapter. The first section obtains the results from a large forced non-helical simulation, with $N^3=1024^3$ grid points, and the resulting characteristic features it has. A set of remarks regarding the magnetic Prandtl number are given as well. Afterwards, a series of forced non-helical simulations are used to show that the kinetic energy spectrum follows the Kolmogorov $k^{-5/3}$ scaling when the magnetic channel is weak (in comparison with the kinetic channel). The same is done to check for Kazantsev $k^{3/2}$ scaling for the magnetic energy spectrum in simulations with $Pr_M \geq 1$ that have achieved dynamo action~\cite{haugen2004simulations}. 

After these brief consistency checks for the eDNS2017 code, several simulations were used in order to study the onset of dynamo action (all were forced with the negative damping forcing described in~\cite{chalupa2017comparison} and, hence, without injection of helicity). The definition of dynamo action that was worked with was that of~\cite{schnack2009lectures} (page 266), which was restated here in section~\ref{sec3.3} and arguing that when simulations reach a steady state in forced simulations it can be considered as if an ``infinite'' time was achieved. Which is supported by the ergodic theorem in~\cite{biskamp1997nonlinear}. Furthermore, it is claimed that from these simulations, all those with dynamo action are undergoing small-scale dynamo action since they have no kinetic helicity. At first, and following from claims of~\cite{schekochihin2004critical} about the critical magnetic Reynolds number having a dependence of the Reynolds number, a critical magnetic Reynolds number was found for $\eta=0.01 \text{ and } 0.0125$ that showed dynamo action at $Pr_M=1$ by decreasing $Pr_M$, and then by increasing it to $Pr_M > 1$. Doing so it was found that there were two different $Re_M^{crit}$ for each value of $\eta$ depending on whether $Pr_M \leq 1$ or $Pr_M \geq 1$. 

Finally, a few remarks regarding the injection of kinetic helicity (through helical forcing) into different systems is provided. Namely, once helicity is injected into the system the critical magnetic Reynolds number (both with $Pr_M < 1$ and $Pr_M > 1$) decreases. This boost of the total magnetic energy is likely due to $\alpha$-effect, which is characteristic to large-scale dynamo action. For this reason it is possible to say that the injection of kinetic helicity leads to the generation of large-scale dynamos, which are known to generate mean magnetic fields.

\section{Simulation with $N^3=1024^3$ grid points}

The first simulation was done in a large box, $N^3=1024^3$, for which viscosity ($\nu=0.005$) was ten times larger than magnetic diffusivity, i.e. $Pr_M=\nu/\eta=10$. As it was mentioned before, the magnetic Prandtl number compares the kinetic and the magnetic channels. That is, it compares how turbulent the magnetic field is relative to the velocity field, which is equivalent to comparing the magnetic Reynolds number against the kinetic magnetic Reynolds number $Pr_M=Re_M/Re$.  

\begin{figure}[!ht]
\centering
\includegraphics[width=0.9\textwidth]{{img/f_1024_0.005_10_fieldslice}.png}
\caption{Heat map of $\vert u \vert$ (left) and $\vert b \vert$ (right) of a vertical  slice of a $N^3=1024^3$ box.}
\label{fig5.1}
\end{figure}

For this simulation, \texttt{Paraview} was used to create a two-dimensional slice of the velocity and the magnetic fields' magnitude. Figure~\ref{fig5.1} shows these slices, and a few comments can be made about them. First of all, it is noted that the velocity field has a much stronger magnitude than the magnetic field. This is likely due to the fact that the velocity field is the one that is forced with the negative damping forcing at $k_f=2$. It is also interesting to note that there appears to be a sort of duality between $\vert u \vert$ and $\vert b \vert$ - which is apparent by the structures formed by each field. For example, the bright red area in the top central section of the $\vert b \vert $ image has an inverse dual on the $\vert u \vert$ slice. This inverse duality can be seen all over fig.~\ref{fig5.1}. 

Additionally, the magnetic field is clearly more fine-grained than the velocity field, which makes sense given that the $\bm b$ is ten times more turbulent than $\bm u$. Quantitatively, this can be interpreted through the kinetic and magnetic Reynolds numbers. As it was mentioned before, these are a measure of how turbulent a specific field is. For the magnetic field, $Re_M=1291\pm50$ and for the velocity field, $Re=129\pm5$, where the errors obtained come from the errors output by the \texttt{time\_av.sh} post-processing script along with basic (addition, division, powers) error propagation rules (eqns.~\ref{eq5.1}). This difference in Reynolds numbers comes with an important difference of the dissipation wave numbers of each field. A similar behaviour, both for the inverse duality and for the fine-graininess of the field with comparatively lower Reynolds number, is also observed in~\cite{schekochihin2007fluctuation}'s figure 2 for the cross section of $\vert u \vert$ and $\vert b \vert$. 

\begin{subequations}
 \begin{align}
  Q &= a + b - x - y \nonumber \\
  \delta Q &= \sqrt{(\delta a)^2 + (\delta b)^2 + (\delta x)^2 + (\delta y )^2} \label{eq5.1.1} \\
  Q &= \frac{a b}{x y} \nonumber \\
  \delta Q &= \vert Q \vert \sqrt{\left( \frac{\delta a}{a} \right)^2 + \left( \frac{\delta b}{b} \right)^2 + \left( \frac{\delta x}{x} \right)^2 + \left( \frac{\delta y}{y} \right)^2} \label{eq5.1.2} \\
  Q &= x^n \nonumber \\
  \delta Q &= \vert Q \vert \vert n \vert \frac{\delta x}{\vert x \vert } \label{eq5.1.3}
 \end{align}
\label{eq5.1}
\end{subequations}

Given that laminar flows have a smaller dissipation wave numbers ($k_\nu$ and $k_\eta$) than turbulent flows, and that energy dissipation through either channel mainly occurs close to the respective dissipation wave numbers, the magnetic energy spectrum should have more energy in the larger wave numbers than the kinetic energy spectrum (since $k_\nu < k_\eta$). In fact, these dissipation wave numbers can be obtained through eqns.~\ref{eq2.7} and~\ref{eq3.5}, and correspond to $k_\nu = 33$ and $k_\eta=183$. Using a simple \texttt{bash} script, the spectral image of the $N^3=1024^3$ box's kinetic and magnetic energies is created, and shown in fig.~\ref{fig5.2}, and confirms the aforementioned suspicion. 

\begin{figure}[!ht]
\centering
\includegraphics[width=0.7\textwidth]{{img/1024/spectra_1024_0.005_10}.png}
\caption{Kinetic (solid red line) and magnetic (dashed blue line) energy spectra. The dissipation wave numbers $k_\nu=33$ and $k_\eta=183$ are also shown. $k=340$ is the maximum wave number that the $N^3=1024^3$ box allows.}
\label{fig5.2}
\end{figure}

In fig.~\ref{fig5.2} the kinetic energy spectrum ($E_K(k)$) is only more energetic in the smaller wave numbers (largest eddies), and decays quickly for the large ones (smaller length scales). In particular, the maximum value of $E_K(k)$ is at the forcing wave number $k_f=2$, and decays as $k$ increases. On the other hand, $E_M(k)$ is maximally energetic around $k\sim10$, and remains at a high energy for a broad range of wave numbers until $k$ is close to the magnetic diffusive wave number $k_\eta$. 

Another important qualitative description that can be obtained regards the energy dissipation through each field. Namely, since the magnetic Prandtl number coA similar behaviour is observed in~\cite{schekochihin2007fluctuation}'s figure 2 for the cross section of $\vert u \vert$ and $\vert b \vert$. mpares the Reynolds numbers of both fields $Pr_M=Re_M/Re$, which is a comparison the energy dissipation of each channel (since the $k_\nu$ and $k_\eta$ are intimately related to energy dissipation)~\cite{brandenburg2011dissipation}. As a result, for the simulation of $N^3=1024^3$ grid points with $Pr_M=10$, one would expect that the energy dissipation through the magnetic channel to be larger than that of the kinetic channel, which is exactly what fig.~\ref{fig5.3} shows.

\begin{figure}[!ht]
\centering
\begin{minipage}{.5\textwidth}
  \centering
  \captionsetup{justification=centering}
  \includegraphics[width=0.95\linewidth]{{img/1024/energy_dissipation_1024_0.005_10}.png}
  \caption{Time evolution of the total magnetic (dashed blue line) and kinetic (solid red line) energy dissipations for the simulation with $N^3=1024^3$ grid points.}
  \label{fig5.3}
\end{minipage}%
\begin{minipage}{.5\textwidth}
  \centering
  \captionsetup{justification=centering}
  \includegraphics[width=0.95\linewidth]{{img/1024/energy_1024_0.005_10}.png}
  \caption{Time evolution of the total magnetic (dashed blue line) and kinetic (solid red line) energies for the simulation with $N^3=1024^3$ grid points.}
  \label{fig5.4}
\end{minipage}
\end{figure}

Finally, and looking at fig.~\ref{fig5.4} that plots the total magnetic (dashed blue line) and kinetic (solid red line) energies in time, it is possible to say that, if a steady state has been reached, dynamo action has been sustained. After stating that the code-time interval [40:50] is steady state in nature, ensemble averages can be obtained. This is due to ergodicity, taking time averages can be associated with taking ensemble averages~\cite{biskamp1997nonlinear}. As a consequence, it is possible to say that, since the average total magnetic energy at the end of various simulations is not zero, then dynamo action has been reached. Since there is no kinetic helicity in the system the dynamo action associated to this system can be said to be small-scale dynamo action.

\subsection{Simulation resolution}

Section~\ref{sec4.2} strongly emphasised the importance of the resolution required for a given simulation. A few additional remarks about it are presented here. Strictly on physical grounds it is straight forward to see that in order to properly resolve a simulation it is paramount to reach the wave numbers that dissipate most energy in the system. Making a simulation with the same parameters as the $N^3=1024^3$ simulation ($\nu=0.005$, $Pr_M=10$), but with a considerably smaller box, $N^3=128^3$ it is possible to see how this affects the results obtained. 

It is worth mentioning that the viscous dissipation wave number is $k\nu=33$ and that the maximum wave number that a $N^3=128^3$ box can achieve is $k_{max}=41$. As a result, one would expect the kinetic channels to look pretty similar in both simulations. However, since the magnetic dissipation wave number is $k_\eta=183$, which is considerably larger than the maximum wave number reached in the $N^3=128^3$ box, it is clear that there should be a substantial difference in the time evolution of the magnetic energy dissipation of both box sizes. Figure~\ref{fig5.5} shows the difference in the kinetic and magnetic energy dissipations of both boxes and fig.~\ref{fig5.6} similarly for $E_K(t)$ and $E_M(t)$.

\begin{figure}[!ht]
\centering
\begin{minipage}{.5\textwidth}
  \centering
  \captionsetup{justification=centering}
  \includegraphics[width=0.95\linewidth]{{img/resolution/energy_dissipation_1024_0.005_10}.png}
  \caption{Time evolution of the total magnetic (dashed blue line $N^3=1024^3$ and dashed dark blue line  $N^3=128^3$) and kinetic (solid red line $N^3=1024^3$ and dashed dark red line  $N^3=128^3$) energy dissipations.}
  \label{fig5.5}
\end{minipage}%
\begin{minipage}{.5\textwidth}
  \centering
  \captionsetup{justification=centering}
  \includegraphics[width=0.95\linewidth]{{img/resolution/energy_1024_0.005_10}.png}
  \caption{Time evolution of the total magnetic (dashed blue line $N^3=1024^3$ and dashed dark blue line  $N^3=128^3$) and kinetic (solid red line $N^3=1024^3$ and dashed dark red line  $N^3=128^3$) energies.}
  \label{fig5.6}
\end{minipage}
\end{figure}

Given that the dissipation of energy mainly occurs close to the dissipative wave numbers, it is no surprise to see that the simulation that was not large enough to resolve $k_\eta=183$ shows considerably less energy dissipation in the magnetic channel (dashed dark blue and blue lines). It is also straight forward to understand why, on the other hand, the kinetic energy dissipation looks roughly the same - since the viscous energy dissipation was resolved in both simulations, most of the kinetic energy dissipation was appropriately calculated.

Figure~\ref{fig5.6} clearly shows that the magnetic energy that is calculated by the simulation with smaller box size is weaker than that obtained with $N^3=1024^3$ grid points. This poses an important problem when trying to determine which simulations maintain dynamo action. The reason behind this is that dynamo action is said to be maintained when the magnetic energy at the end of the simulation is nonzero. However, if the simulation that is being considered lacks the required spatial resolution such that the magnetic energy is (mistakenly) calculated to be weaker (particularly, $E_M(t=t_f)=0$) than its real value ($E_M(t=t_f)=0$), then it could be incorrectly concluded that no dynamo action is sustained by the given values.

If a similar problem happens when calculating the growth rate in decaying simulations, then the results of~\cite{schekochihin2004critical} can be criticised. The main reason to claim this is because all their remarks are given for simulations with $\eta=0.001$ (and some with $\nu$ as small as $0.000125$), which in the eDNS2017 code would have to be resolved by (at least)\footnote{For a simulation generated with eDNS2017 with $\nu=0.001$, the associated dissipative wave number is $k_\nu=103$. $N^3=128^3$ simulations have a maximum wave number $k_{max}^{128^3}=41$ and for a $N^3=256^3$ it is $k_{max}^{256^3}=84$. Consequently, a box size of at least $N^3=512^3$ would be required to resolve a simulation with $\nu=0.001$ (assuming $\eta \geq \nu$), since $k_{max}^{512^3}=169$.} a box size of of $N^3=512^3$ and, for $\nu=0.000125$, $N^3=1024^3$ grid points (or larger)\footnote{For the $N^3=1024^3$ simulation generated ($\nu=0.005$ and $\eta=0.0005$), $k_\eta=183$. $N^3=1024^3$ simulations have a maximum wave number $k_{max}^{256^3}=340$. Consequently, a box size of at least $N^3=1024^3$ would be required to resolve a simulation with $\eta=0.0005$ (assuming $\nu \geq \eta$). Thus it is possible that for a simulation with $\nu=0.000125$ a box even larger than $N^3=1024^3$ would need to be used since $k_{\nu, \eta}$ increase as $\nu, \eta$ decrease.}. This would mean that the simulation performed in~\cite{schekochihin2004critical} are under resolved. And, as a result, some simulations which they claim to have not achieved dynamo action might actually have.  However, a different behaviour could be seen for the growth rate in decaying simulations, in which case the simulations in~\cite{schekochihin2004critical} could have been adequately generated (than that for the magnetic energy). Nonetheless, if the box sizes used in~\cite{schekochihin2004critical} would have been replicated in the forced non-helical simulations generated with the eDNS2017 code for the aforementioned parameters, then all simulations would not have encompassed the entire physical picture. 

\begin{figure}[!ht]
\centering
\includegraphics[width=0.7\textwidth]{{img/resolution/kazantsev_0.0005}.png}
\caption{Magnetic (dashed blue line $N^3=1024^3$ and dashed dark blue line $N^3=128^3$) and kinetic (solid red line $N^3=1024^3$ and solid dark red line $N^3=128^3$) energy spectra. The dissipation wave numbers $k_\nu=33$ and $k_\eta=183$ are also shown. $k=41, 340$ are the maximum wave numbers for the $N^3=128^3$ and $N^3=1024^3$ boxes.}
\label{fig5.7}
\end{figure}

Finally, the kinetic and magnetic energy spectra were also plotted and found to be very similar. This occurs since each box size only provides results for wave number smaller than its own maximum wave number. As a result, the simulation with the smaller box should provide a similar spectral image of both kinetic and magnetic energies in the wave number range [1:41]. Since there is (some) energy transfer from the large wave numbers to the smaller ones, the main difference between the energy spectra between simulations is located close to $k_{max}^{128^3}$, and it is clearly shown in fig.~\ref{fig5.6}.

\section{Kolmogorov and Kazantsev scales}

\subsection{Kolmogorov $k^{-5/3}$ scaling}

A well known theoretical prediction regarding the spectral energy cascade in hydrodynamics is the so-called Kolmogorov scaling (section~\ref{sec2.4}). Namely, Kolmogorov's theory focuses on the inertial subrange, which is close to the Taylor length scale ($\lambda_u=\sqrt{15\nu/\varepsilon}u_{rms}$). More specifically, large enough that dissipative effects due to viscosity do not affect the fluid motion and small enough that the fluid's large scale motions are also neglected. The main theoretical finding was that the kinetic energy spectrum should see a $k^{-5/3}$ scaling in the inertial subrange. 

However, this scaling changes in magnetohydrodynamics depending on the strength of the magnetic energy. Specifically, when the magnetic energy is strong when compared to the kinetic energy, the dynamics of the velocity field is heavily modified by the magnetic field. This leads to a deviation from the Kolmogorov scaling. Nonetheless, when the magnetic energy is considerably weak in comparison to the kinetic energy then the Kolmogorov scaling could exist. Thus it is claimed that the Kolmogorov $k^{-5/3}$ scaling should exist at magnetic Prandtl numbers smaller than one. 

\begin{figure}[!ht]
\centering
\includegraphics[width=0.7\textwidth]{{img/scaling/kolmogorov_0.2}.png}
\caption{Kolmogorov scaling showing convergence in an intermediary wave number range for MHD simulations with low magnetic Prandtl number $Pr_M=0.2$.}
\label{fig5.8}
\end{figure}

Effectively, when running a series of simulations with low magnetic Prandtl number $Pr_M=0.2$ ($\nu=[0.01, 0.0125, 0.015, 0.0175, 0.02, 0.0225]$) it can be seen that the $k^{-5/3}$ scaling is indeed achieved at intermediary wave numbers. The kinetic energy spectra of these runs is shown in fig.~\ref{fig5.8}. For comparison, a second set of simulations was generated with the same values of magnetic diffusivity, but with $Pr_M=2$. As expected, this set of runs does not follow the Kolmogorov scaling (fig.~\ref{fig5.9}) since the magnetic field is strong enough to interfere with the velocity field.

\begin{figure}[!ht]
\centering
\includegraphics[width=0.7\textwidth]{{img/scaling/kolmogorov_2}.png}
\caption{Set of runs with high $Pr_M=2$ that do not show convergence with Kolmogorov $k^{-5/3}$ scaling at any intermediary wave number scale.}
\label{fig5.9}
\end{figure}

\subsection{Kazantsev $k^{3/2}$ scaling}

A theoretical description for magnetohydrodynamics exists for the larger spatial scales, i.e. scales were the nonlinear term's contribution is negligible and neither viscosity nor magnetic diffusivity are important, in non-helical flows with $Pr_M \geq 1$. Said description was developed by Kazantsev~\cite{kazantsev1968enhancement}, who found a scaling law of $k^{3/2}$ for the magnetic field in small wave numbers. 

It was mentioned before that to get the hydrodynamic Kolmogorov $k^{-5/3}$ scaling law in MHD the magnetic field had to be weak enough that it did not interfere strongly with the velocity field. For Kazantsev scaling its quite the opposite since the magnetic field needs to be strong (compared to $E_K(k)$) in order to achieve the Kazantsev $k^{3/2}$ scaling. This range is called the kinematic regime. More specifically, Kazantsev theory is only valid when the velocity field is exclusively made up of spatially large components, which is equivalent of having $Pr_M \gg 1$~\cite{haugen2004simulations}. An extensive description of Kazantsev theory and its limitations is discussed in~\cite{haugen2004simulations}. 

In order to check whether the spectral image of the magnetic field calculated by eDNS2017 follow Kazantsev $k^{3/2}$ scaling a series of runs with high magnetic Prandtl number were generated. It was found that Kazantsev scaling was indeed followed by simulation with $Pr_M \geq 1$, but only in the case were said simulations had achieved dynamo action. Figure~\ref{fig5.10} shows $E_M(k)$ for several runs ($\eta=0.01$ and $\nu=[0.01, 0.05, 0.06, 0.07, 0.1, 1]$) and confirms that the Kazantsev scaling is (roughly) followd at the largest spatial scales (smallest wave numbers), except for the $\nu=1$ ($Pr_M=100$) run because this one did not achieve dynamo action. It can thus be concluded that Kazantsev scaling describes the large spatial scales for $Pr_M \geq 1$ only for simulations that sustain dynamo action.

\begin{figure}[!ht]
\centering
\includegraphics[width=0.7\textwidth]{{img/scaling/kazantsev_0.01_close}.png}
\caption{Set of runs with high $Pr_M$ that show convergence with Kazantsev $k^{3/2}$ scaling at the kinematic regime.}
\label{fig5.10}
\end{figure}

\begin{figure}[!ht]
\centering
\includegraphics[width=0.6\textwidth]{img/scaling/k3halfs}
\caption{Kazantsev scaling for the magnetic energy for simulations with ${Pr_M=500}$~\cite{schekochihin2004simulations}.}
\label{fig5.11}
\end{figure}

The Kazantsev scaling of $k^{3/2}$ can also be seen in the kinematic range in the spectral image of the magnetic field for very large magnetic Prandtl number in~\cite{schekochihin2004simulations}. The simulations shown in fig.~\ref{fig5.11} are the corresponding $E_M(k)$ (dubbed $M(k)$ in the figure). It is worth noting that these simulations have considerably smaller magnetic diffusivity ($\eta=0.0001$), which is why at $Pr_M=500$ dynamo action is still sustained. However, there exists a large enough magnetic Prandtl number that will indubitably shut down the dynamo~\cite{schekochihin2004critical}. 

\section{Onset of dynamo action}
\label{sec5.3}

This section details studies done regarding the onset of dynamo action by changing the kinematic viscosity and the magnetic diffusivity of forced, non-helical simulations on magnetohydrodynamic homogeneous isotropic turbulence in a triply periodic box. Using the definition of dynamo action presented in section~\ref{sec3.3}, that states that an MHD system sustains dynamo action as long as the total magnetic energy when time goes to infinity is nonzero~\cite{schnack2009lectures}. 

Having defined dynamo action, the first thing that is important is to provide a method to tell whether or not dynamo action has been reached. For the purpose of trying to determine if dynamo action is obtained in simulations from the eDNS code the method used was to check the value of the time-averaged total magnetic energy (once the steady state of the simulation was reached). As it was mentioned earlier, the ergodic theorem states that these temporal averages are equivalent to ensemble averages~\cite{biskamp1997nonlinear}. This can be justified by saying that the temporal average (ensemble average) value of the total magnetic energy in the steady state is the same as the total magnetic energy when time goes to infinity, $E_M(t\rightarrow\infty)=\langle E_M^{ss} \rangle$.

\subsection{$Re_M^{crit}$ for $Pr_M=1$}

For the following simulations the forcing that was done was exclusively kinetic, i.e. $\bm f_b = \bm 0$, and there was no injection of helicity. Looking at these non-helical simulations the question about when does the onset of dynamo action occurs. Looking at runs with $Pr_M = 1$ lead to the conclusion that there exists a critical value for the magnetic diffusivity $\eta$ for which small-scale dynamo action appears. This is obviously related to a critical magnetic Reynolds number since $Re_M=uL/\eta$, and it is widely documented in the study of dynamo action both from a theoretical (Kazantsev and Batchelor theories) and a numerical point of view~\cite{kazantsev1968enhancement, schekochihin2004critical, haugen2004simulations, batchelor1950spontaneous, schekochihin2007fluctuation, tobias2011mhd}. In fact, there seems to be a consensus about the critical magnetic Reynolds number for unity magnetic Prandtl number within the range [30:60]~\cite{brandenburg2005astrophysical, kazantsev1968enhancement}.

Doing a series of simulations with unity magnetic Prandtl number with varying magnetic diffusivity within the range $\eta=[0.01-1.75]$ up to code-time $100$ the onset of dynamo action was observed between $\eta=0.015$ and $\eta=0.0175$. The total magnetic energy in time can be seen in fig.~\ref{fig5.12}, which corresponds to runs S0 to S3 in table~\ref{tableB1.1}. The relation between the maximum wave number and the Kolmogorov microscales $k_{max}/k_\nu$ and $k_{max}/k_\eta$

\begin{figure}[!ht]
\centering
\includegraphics[width=0.7\textwidth]{{img/prm1/ss_prm_1_short}.png}
\caption{Temporal evolution of the total magnetic energy for simulations with ${Pr_M=1}$ from $t=60$ to $t=100$.}
\label{fig5.12}
\end{figure}

\subsection{$Re_M^{crit}$ for $Pr_M > 1$}

The range of magnetic Prandtl number was then broadened and it was seen that this critical value of magnetic Reynolds number depends on $Pr_M$. The first thing that was necessary to study the onset of small-scale dynamo action was to define a way to determine weather there was dynamo action or not in a specific simulation.

For simulations with $Pr_M$ larger than unity it was possible to identify a critical magnetic Reynolds number $Re_M$. After doing this it was possible to obtain a critical magnetic Prandtl number for which dynamo action is shut down. This qualitatively agrees with the results shown in~\cite{schekochihin2004critical}.






\section{Critical magnetic Prandtl number for small-scale dynamos}

A critical magnetic Reynolds number was found to be $Re_M^{crit}=55\pm5$ for simulations with $Pr_M\gtrsim1$, which is very close to a reported value of $Re_M^{crit}\sim60$ (also for $Pr_M\gtrsim1$) in~\cite{schekochihin2007fluctuation}.\\

other result for checks!\\

in~\cite{haugen2004simulations} they claim to have a critical magnetic Reynolds number of around 35, when defined with $Re_M=u_{rms}/(\eta k_f)$, for magnetic Prandtl number of unity. Doing that in my simulations, an equivalent simulation is \texttt{128\_0.0125\_1}, for which the critical magnetic Reynolds number defined with the forcing wavenumber is $21 \pm 1$.











\section{Discussion of your results}

This section should give a picture of what you have taken out of your
project and how you can put it into context.

This section should summarise the results obtained, detail conclusions
reached, suggest future work, and changes that you would make if you
repeated the project.

\chapter{Conclusions}

This is the place to put your conclusions about your work. You can
split it into different sections if appropriate. You may want to include
a section of future work which could be carried out to continue your
research.

The conclusion section should be at least one page long, preferably 2
pages, but not much longer.

\appendix
\chapter{Sample input file for eDNS2017}
\label{apx1}

Sample input file for a run going to \texttt{TIME~~400} with $\nu=0.9$ and $Pr_M=90$ with helical forcing (\texttt{F\_UHELICITY~~1.0}) in wave number $k_f=2$.

\lstinputlisting[language=bash]{input.in}

\chapter{Tables for section~\ref{sec5.3}}

\begin{table}[h]
\begin{center}
\begin{tabular}{||c|c|c|c|c|c|c|c||}
\hline
\textbf{Run} & $ \bm{\eta} $ & $ \bm{ Pr_M} $ & $ \bm{ Re} $ & $ \bm{ Re_M} $ & $ \bm{ \frac{k_{max}}{k_\nu}} $ & $ \bm{ \frac{k_{max}}{k_\eta}} $ & $ \bm{ \langle E_M^{ss}} \rangle $ \\ \hline \hline
S0 & 0.01 & 1 & $ 69 \pm 6 $ & $ 69 \pm 6 $ & $ 2.33911 $ & $ 2.33911 $ & $ 0.022 \pm 0.003 $ \\ \hline
S1 & 0.0125 & 1 & $ 55 \pm 4 $ & $ 68 \pm 5 $ & $ 2.77289 $ & $ 2.34558 $ & $ 0.014 \pm 0.001 $ \\ \hline
S2 & 0.015 & 1 & $ 43 \pm 3 $ & $ 64 \pm 5 $ & $ 1.5311 $ & $ 1.12962 $ & $ 0.005 \pm 0.001 $ \\ \hline
S3 & 0.0175 & 1 & $ 37 \pm 2 $ & $ 65 \pm 3 $ & $ 1.69408 $ & $ 1.11341 $ & $ 0.001 \pm 0.000 $ \\ \hline \hline
L0 & 0.01 & 1 & $ 69 \pm 4 $ & $ 69 \pm 4 $ & $ 2.30562 $ & $ 2.30562 $ & $ 0.023 \pm 0.004 $ \\ \hline
L1 & 0.0125 & 1 & $ 56 \pm 4 $ & $ 70 \pm 4 $ & $ 2.70774 $ & $ 2.29048 $ & $ 0.007 \pm 0.003 $ \\ \hline
L2 & 0.015 & 1 & $ 46 \pm 4 $ & $ 69 \pm 6 $ & $ 1.52046 $ & $ 1.12177 $ & $ 0.000 \pm 0.000 $ \\ \hline
L3 & 0.0175 & 1 & $ 39 \pm 3 $ & $ 69 \pm 6 $ & $ 1.70577 $ & $ 1.1211 $ & $ 0.000 \pm 0.000 $ \\ \hline
\end{tabular}
\end{center}
\caption{Runs for the onset of dynamo action in the $Pr_M=1$ case. The S-runs are only from code time 0 to 100, while the L-runs are (at least) from code time 0 to 300.}
\label{tableB1.1}
\end{table}


\bibliography{MSc-dissertation}
\bibliographystyle{unsrt}

\end{document}

